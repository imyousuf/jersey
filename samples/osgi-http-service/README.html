<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>OSGi HttpService Example</title></head>


  <body>
      <h1>OSGi HttpService Example</h1>
      
      <p>This example demonstrates how to develop a simple OSGi bundle registering 
      a Jersey based RESTful web service as an <a href="http://www.osgi.org/javadoc/r4v42/org/osgi/service/http/HttpService.html">OSGi HttpService</a></p>
      
      <h2>Contents</h2>
      <p>The example bundle (see the <tt>bundle</tt> module) consists of just one Jersey resource:</p>
      <dl>
          <dt><code>com.sun.jersey.samples.osgihttpservice.StatusResource</code></dt>
          <dd>that produces a textual response to an HTTP GET</dd>
      </dl>
    <p>The mapping of the URI path space is presented in the following table:</p>
	<table border="1">
	<tr>
	<th>URI path</th>
	<th>Resource class</th>
	<th>HTTP methods</th>
	</tr>
	<tr>
	<td>/status</td>
	<td>StatusResource</td>
	<td>GET</td>
	</tr>
	</table>

      <h2>Running the Example</h2>
      <p>To run the example, you would need to build the OSGi bundle in the <tt>bundle</tt> module 
      and install it to an OSGi runtime (e.g. Apache Felix) together with other OSGi bundles.
      Look at the attached <tt>functional-test</tt> module for details on the programmatical runtime configuration</p> 
      
      <p>After downloading and installing <a href="http://felix.apache.org/site/index.html">Felix</a>, you can also start the HTTP service manually as shown below. 
      The following steps are known to work with the Felix version 3.0.6: 
<pre>      
%java -jar bin/felix.jar
____________________________
Welcome to Apache Felix Gogo

g! lb
START LEVEL 1
   ID|State      |Level|Name
    0|Active     |    0|System Bundle (3.0.6)
    1|Active     |    1|Apache Felix Bundle Repository (1.6.2)
    2|Active     |    1|Apache Felix Gogo Command (0.6.1)
    3|Active     |    1|Apache Felix Gogo Runtime (0.6.1)
    4|Active     |    1|Apache Felix Gogo Shell (0.6.1)
g! install http://apache.opensourceresources.org//felix/org.apache.felix.configadmin-1.2.8.jar
Bundle ID: 5
g! install http://apache.opensourceresources.org//felix/org.apache.felix.eventadmin-1.2.6.jar
Bundle ID: 6
g! install http://repo2.maven.org/maven2/org/ops4j/pax/web/pax-web-jetty-bundle/0.7.1/pax-web-jetty-bundle-0.7.1.jar
Bundle ID: 7
g! install http://download.java.net/maven/2/com/sun/jersey/jersey-core/1.5-SNAPSHOT/jersey-core-1.5-SNAPSHOT.jar
Bundle ID: 8
g! install http://download.java.net/maven/2/com/sun/jersey/jersey-server/1.5-SNAPSHOT/jersey-server-1.5-SNAPSHOT.jar
Bundle ID: 9
g! install file:bundle-1.5-SNAPSHOT.jar
Bundle ID: 10 
g! lb
START LEVEL 1
   ID|State      |Level|Name
    0|Active     |    0|System Bundle (3.0.6)
    1|Active     |    1|Apache Felix Bundle Repository (1.6.2)
    2|Active     |    1|Apache Felix Gogo Command (0.6.1)
    3|Active     |    1|Apache Felix Gogo Runtime (0.6.1)
    4|Active     |    1|Apache Felix Gogo Shell (0.6.1)
    5|Installed  |    1|Apache Felix Configuration Admin Service (1.2.8)
    6|Installed  |    1|Apache Felix EventAdmin (1.2.6)
    7|Installed  |    1|OPS4J Pax Web - Jetty Bundle (0.7.1)
    8|Installed  |    1|jersey-core (1.5.0.SNAPSHOT)
    9|Installed  |    1|jersey-server (1.5.0.SNAPSHOT)
   10|Installed  |    1|OSGi HttpService - Jersey Sample Bundle (1.5.0.SNAPSHOT)
g! start 5 6 7 8 9 10
DEBUG: EventAdmin: org.apache.felix.eventadmin.CacheSize=30
DEBUG: EventAdmin: org.apache.felix.eventadmin.ThreadPoolSize=20
DEBUG: EventAdmin: org.apache.felix.eventadmin.Timeout=5000
DEBUG: EventAdmin: org.apache.felix.eventadmin.RequireTopic=true
DEBUG: EventAdmin: org.apache.felix.eventadmin.CacheSize=30
DEBUG: EventAdmin: org.apache.felix.eventadmin.ThreadPoolSize=20
DEBUG: EventAdmin: org.apache.felix.eventadmin.Timeout=5000
DEBUG: EventAdmin: org.apache.felix.eventadmin.RequireTopic=true
Nov 8, 2010 12:00:29 PM com.sun.jersey.samples.osgihttpservice.Activator start
INFO: STARTING HTTP SERVICE BUNDLE
Nov 8, 2010 12:00:29 PM com.sun.jersey.samples.osgihttpservice.Activator rawRegisterServlets
INFO: JERSEY BUNDLE: REGISTERING SERVLETS
Nov 8, 2010 12:00:29 PM com.sun.jersey.samples.osgihttpservice.Activator rawRegisterServlets
INFO: JERSEY BUNDLE: HTTP SERVICE = org.ops4j.pax.web.service.internal.HttpServiceProxy@9ac5f13
Nov 8, 2010 12:00:29 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.5-SNAPSHOT 10/22/2010 01:30 AM'
Nov 8, 2010 12:00:29 PM com.sun.jersey.server.impl.application.DeferredResourceConfig$ApplicationHolder <init>
INFO: Instantiated the Application class com.sun.jersey.samples.osgihttpservice.JerseyApplication
Nov 8, 2010 12:00:30 PM com.sun.jersey.samples.osgihttpservice.Activator rawRegisterServlets
INFO: JERSEY BUNDLE: SERVLETS REGISTERED
Nov 8, 2010 12:00:30 PM com.sun.jersey.samples.osgihttpservice.Activator start
INFO: HTTP SERVICE BUNDLE STARTED
</pre>

Now the Jersey resource should become 
available at <a href="http://localhost:8080/jersey-http-service/status">http://localhost:8080/jersey-http-service/status</a>
</p>      
 </body></html>
